machine:
  node:
    version: 4.2.1

dependencies:
  pre:
    - npm i -g tslint typings coveralls type
    - typings i
  cache_directories:
    - "node_modules"
    - "typings"

test:
  pre:
    - mkdir -p $CIRCLE_TEST_REPORTS/mocha/
  override:
    - npm run pretest
    - npm run ci-test
    - npm run posttest
  post:
    - npm run coverage
    - cp -R ./.test/coverage/ ./
    - coveralls < ./coverage/lcov.info
