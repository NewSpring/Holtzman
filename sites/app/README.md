<p align="center" >
  <a href="http://newspring.cc">
    <img src="https://s3.amazonaws.com/ns.images/newspring/icons/newspring-church-logo-black.png" alt="NewSpring Church" title="NewSpring Church" />
  </a>
</p>

Native App for NewSpring Church
=======================

Native app for NewSpring targeting iOS and Android OSes. More coming...

## Documentation

Each folder level should contain an README.md explaining what the scope of the folder is and any API endpoints to be used.

## Getting Started

```shell
git clone https://github.com/NewSpring/apollos

cd sites/app

# install node modules
npm install

# get dependencies
norma build

# run
norma
```

## Heighliner Database

We are currently using [heighliner-expression-engine](https://github.com/NewSpring/heighliner-expression-engine) to sync data from NewSpring's main Expression Engine database to a Mongo database for use with Meteor.

To use this locally:

1. Follow this setup [here](https://github.com/NewSpring/heighliner-expression-engine#development).
2. Ensure your docker env is setup: `eval $(docker-machine env default)`
3. Get IP address of docker: `docker-machine ip default`
4. Run norma/meteor with this IP address as your mongo instance: `MONGO_URL=mongodb://[INSERT IP ADDRESS]:27017/test norma`

## Exporting Production Database

To get production data without running Heighliner locally (too hot), follow these steps:

1) Dump database:

```
mongodump -h host:port -u username -p password -d databasename --excludeCollection=accounts --excludeCollection=campuses --excludeCollection=clusterEndpoints --excludeCollection=definedValues --excludeCollection=groupLocations --excludeCollection=groupMembers --excludeCollection=groups --excludeCollection=groupTypes --excludeCollection=locations --excludeCollection=paymentDetails --excludeCollection=people --excludeCollection=queuedApiRequests --excludeCollection=savedAccounts --excludeCollection=scheduledTransactions --excludeCollection=serverWatches --excludeCollection=status --excludeCollection=TestCollection --excludeCollection=transactions
```

2) Start local meteor:

```
norma
```

3) cd to dump/databasename folder generated by mongodump

```
mongorestore -h 127.0.0.1:3001 -d meteor ./dump/databasename/
```
